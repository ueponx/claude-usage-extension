# Claude使用量チェッカー Chrome拡張機能 v2.1

Claude.aiの使用量を簡単に確認できるChrome拡張機能です。

## 🎉 v2.1の変更点

- ✅ **自動更新を有効化**: 全ページで5分ごとに自動更新
- ✅ **時刻表示の改善**: 実際の取得時刻（HH:mm形式）を表示
- ✅ **リロード時のタブ重複問題を修正**: 🔄ボタンで1つのタブのみが開く
- ✅ **データ抽出エラーの改善**: ページ読み込み待機時間を最適化

---

## 📥 インストール方法

### ステップ1: 既存バージョンの削除（アップグレードの場合）

既に旧バージョンをインストールしている場合:

1. Chromeで `chrome://extensions/` を開く
2. Claude使用量チェッカーの**削除**をクリック

### ステップ2: v2.1のインストール

1. zipファイルをダウンロードして解凍
2. Chromeで `chrome://extensions/` を開く
3. 右上の**デベロッパーモード**をONにする
4. **パッケージ化されていない拡張機能を読み込む**をクリック
5. 解凍したフォルダを選択

---

## 📊 使い方

### 基本操作

拡張機能をインストールすると、Claude.aiのページに**フローティングウィジェット**が自動表示されます。

**ウィジェットの機能**:
- **ドラッグ**: ウィジェットを好きな位置に移動
- **🔄ボタン**: 最新データに手動更新
- **−ボタン**: 折りたたみ/展開
- **×ボタン**: 非表示

**ウィジェットを再表示**:
- ツールバーの拡張機能アイコンをクリック
- または、ページをリロード（Ctrl+R / Cmd+R）

### 時刻表示の仕様

最終更新時刻は以下の形式で表示されます:

- **1時間以内**: `13:45 (15分前)`
- **24時間以内**: `09:30 (3時間前)`
- **それ以上**: `2025/10/30 14:30:00`

---

## 📋 表示される情報

- **Current Session**: 現在のセッションの使用量
- **All Models**: 全モデルの週間使用量
- **Opus Only**: Opusモデルの使用量
- **リセット時間**: 各制限のリセットタイミング

---

## ⚙️ 技術仕様

### キャッシュ管理

- **キャッシュ有効期限**: 5分
- **自動更新**: 5分ごとに自動更新
- **初回起動**: 自動でデータ取得
- **以降**: キャッシュから表示し、5分ごとに自動更新

### データ取得

- **方法**: 使用量ページをバックグラウンドで開いてデータを抽出
- **タブ**: 既存タブを優先利用、なければバックグラウンドで作成
- **待機時間**: ページロード後3秒待機（動的レンダリング対応）

---

## 🔧 トラブルシューティング

### ウィジェットが表示されない

1. ページをリロード（Ctrl+R / Cmd+R）
2. `chrome://extensions/` で拡張機能が有効か確認
3. 拡張機能を削除して再インストール

### データが取得できない

1. 使用量ページ（https://claude.ai/settings/usage）を開いて待つ
2. 🔄ボタンをクリックして再試行
3. ブラウザのコンソール（F12）でエラーを確認

### エラーメッセージが表示される

1. ページが完全に読み込まれるまで待つ（3〜5秒）
2. ページをリロード
3. 拡張機能を再インストール

---

## 📂 ファイル構成

```
claude-usage-extension/
├── manifest.json          # 拡張機能の設定
├── background.js          # バックグラウンド処理
├── content.js             # データ抽出
├── floating-widget.js     # ウィジェット表示
├── floating-widget.css    # スタイル
├── icons/                 # アイコン画像
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md              # このファイル
```

---

## 🎯 動作確認済み環境

- **ブラウザ**: Google Chrome (最新版)
- **OS**: Windows, macOS, Linux
- **Claude.ai**: 日本語版・英語版

---

## 📝 開発情報

### バージョン履歴

**v2.1** (2025-10-31)
- 自動更新を有効化（5分ごと）

**v2.0** (2025-10-31)
- 時刻表示の改善（「たった今」→実際の取得時刻）
- リロード時のタブ重複問題を修正
- データ抽出エラーの改善

**v1.6** (2025-10-31)
- リロード時のタブ重複問題を修正
- データ抽出エラーの改善

**v1.5** (2025-10-30)
- キャッシュ有効期限を5分に短縮

**v1.0-1.4**
- 初期バージョンと基本機能の実装

---

## 📄 ライセンス

MIT License

すべてチェックが入れば、正常に動作しています！🎉
